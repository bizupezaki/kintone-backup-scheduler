# kintone バックアップ記録アプリ フィールド定義

このドキュメントは、バックアップ履歴を記録するための kintone アプリに必要なフィールドの定義です。

## フィールド一覧

| フィールド名             | フィールドコード     | kintone タイプ   | 必須 | 説明                                 |
| ------------------------ | -------------------- | ---------------- | ---- | ------------------------------------ |
| バックアップ日時         | `backup_datetime`    | DATETIME         | ✓    | バックアップ開始日時                 |
| 対象アプリ ID            | `target_app_id`      | NUMBER           | ✓    | kintone アプリ ID（整数）            |
| 対象アプリ名             | `target_app_name`    | SINGLE_LINE_TEXT | ✓    | アプリ名（自動取得）                 |
| レコード数               | `record_count`       | NUMBER           | ✓    | バックアップしたレコード数           |
| 処理ステータス           | `status`             | DROP_DOWN        | ✓    | 実行中/成功/失敗/部分成功/キャンセル |
| 処理時間(秒)             | `duration_seconds`   | NUMBER           |      | 処理にかかった秒数（小数可）         |
| エラー詳細               | `error_details`      | MULTI_LINE_TEXT  |      | エラーメッセージ・スタックトレース   |
| バックアップ種別         | `backup_type`        | DROP_DOWN        | ✓    | 全体/差分/復元/検証                  |
| バックアップファイルパス | `file_path`          | SINGLE_LINE_TEXT |      | 保存先ファイルパス（相対パス）       |
| 実行トリガー             | `trigger_type`       | DROP_DOWN        |      | 手動/スケジュール/自動(差分)         |
| 差分基準日時             | `diff_base_datetime` | DATETIME         |      | 差分バックアップの基準日時           |
| データサイズ(MB)         | `data_size_mb`       | NUMBER           |      | バックアップデータサイズ             |
| 圧縮率(%)                | `compression_ratio`  | NUMBER           |      | 圧縮率パーセンテージ                 |
| API リクエスト数         | `api_request_count`  | NUMBER           |      | kintone API コール回数               |
| リトライ回数             | `retry_count`        | NUMBER           |      | エラー時のリトライ回数               |
| 実行ホスト名             | `hostname`           | SINGLE_LINE_TEXT |      | 実行した PC 名                       |
| アプリバージョン         | `app_version`        | SINGLE_LINE_TEXT |      | アプリケーションバージョン           |
| 備考                     | `remarks`            | MULTI_LINE_TEXT  |      | 手動メモ                             |

## ドロップダウン選択肢

### 処理ステータス (`status`)

| 選択肢     | 値           |
| ---------- | ------------ |
| 実行中     | `実行中`     |
| 成功       | `成功`       |
| 失敗       | `失敗`       |
| 部分成功   | `部分成功`   |
| キャンセル | `キャンセル` |

### バックアップ種別 (`backup_type`)

| 選択肢 | 値     |
| ------ | ------ |
| 全体   | `全体` |
| 差分   | `差分` |
| 復元   | `復元` |
| 検証   | `検証` |

### 実行トリガー (`trigger_type`)

| 選択肢       | 値             |
| ------------ | -------------- |
| 手動         | `手動`         |
| スケジュール | `スケジュール` |
| 自動(差分)   | `自動(差分)`   |

## アプリ作成手順

1. kintone にログイン
2. 新規アプリを作成（「はじめから作成」を選択）
3. アプリ名を「バックアップ記録」などに設定
4. 上記のフィールドを全て追加
5. フィールドコードを正確に設定（コードは英数字で入力）
6. ドロップダウンの選択肢を設定
7. アプリを公開
8. アプリ ID をメモしておく（URL の `k=` の後の数字）

## 注意事項

-   フィールドコードは必ず上記の通りに設定してください（大文字・小文字も区別されます）
-   NUMBER 型のフィールドは小数点以下の桁数を適切に設定してください
-   このアプリには、バックアップを実行するアカウントに対して「レコード追加」「レコード編集」の権限を付与してください
-   バックアップ実行時に自動的にレコードが追加されます

## 推奨設定

-   **一覧の初期表示**: バックアップ日時の降順（最新が上に表示されるように）
-   **アクセス権**: 管理者と実行アカウントのみが編集可能
-   **通知設定**: 処理ステータスが「失敗」になった場合に管理者に通知
